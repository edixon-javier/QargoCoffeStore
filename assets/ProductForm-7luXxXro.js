import{b as R,m as q,j as e,i as I,c as O}from"./index-BeUTusdR.js";import{b as B,d as K,r as m}from"./vendor-CuftA7A4.js";import{m as M}from"./mockSuppliers-Buh3I-tH.js";import{A as W}from"./arrow-left-D0i7R-kr.js";import{T as E}from"./trash-2-3myatCiM.js";import{P as G}from"./plus-D7rzxen9.js";import{S as H}from"./save-AiJwg_c6.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=R("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),X={id:"",name:"",description:"",sku:"",price:0,images:[],category:{id:"",name:"",slug:""},supplier:{id:"",name:"",contactEmail:"",contactPhone:"",address:{street:"",city:"",state:"",zipCode:"",country:""},status:"active",createdAt:""},stock:0,minOrderQuantity:1,specifications:{},isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},ie=({mode:x})=>{const f=B(),{id:j}=K(),[d,p]=m.useState(X),[$,D]=m.useState(x==="edit"),[i,v]=m.useState({}),[k,S]=m.useState(!1),[P,z]=m.useState([]),[g,C]=m.useState(""),[h,A]=m.useState(""),[b,N]=m.useState([""]);m.useEffect(()=>{if(z(M),x==="edit"&&j){const s=setTimeout(()=>{const r=q.find(t=>t.id===j);r&&(p(r),N(r.images.length>0?r.images:[""])),D(!1)},800);return()=>clearTimeout(s)}},[j,x]);const w=(s,r)=>{if((r===""||r===0)&&["name","sku","price","category.id","supplier.id"].includes(s))return`${s} is required`;if(s==="price"||s==="salePrice"||s==="stock"){const t=Number(r);if(isNaN(t)||t<0)return"Must be a positive number"}return""},c=s=>{const{name:r,value:t}=s.target;if(r.includes(".")){const[l]=r.split(".");if(l==="category"){const u=O.find(n=>n.id===t);u&&p(n=>({...n,category:u}))}else if(l==="supplier"){const u=P.find(n=>n.id===t);u&&p(n=>({...n,supplier:u}))}const y=w(r,t);F(r,y);return}let a=t;r==="price"||r==="salePrice"||r==="stock"||r==="minOrderQuantity"?a=t===""?0:Number(t):r==="isActive"&&(a=t==="true");const o=w(r,a);F(r,o),p(l=>({...l,[r]:a}))},F=(s,r)=>{v(r?t=>({...t,[s]:r}):t=>{const a={...t};return delete a[s],a})},U=()=>{!g.trim()||!h.trim()||(p(s=>({...s,specifications:{...s.specifications,[g]:h}})),C(""),A(""))},Q=s=>{p(r=>{const t={...r.specifications};return delete t[s],{...r,specifications:t}})},T=(s,r)=>{const t=[...b];t[s]=r,N(t)},L=()=>{N([...b,""])},V=async s=>{s.preventDefault();const r=["name","sku","price","category.id","supplier.id"],t={};if(r.forEach(a=>{var y,u;let o;if(a.includes(".")){const[n]=a.split(".");n==="category"&&a==="category.id"?o=((y=d.category)==null?void 0:y.id)||"":n==="supplier"&&a==="supplier.id"&&(o=((u=d.supplier)==null?void 0:u.id)||"")}else o=d[a];const l=w(a,o);l&&(t[a]=l)}),Object.keys(t).length>0){v(t);return}try{S(!0);const a=b.filter(l=>l.trim()!==""),o={...d,images:a,updatedAt:new Date().toISOString()};x==="create"&&(o.id=`new-${Date.now()}`,o.createdAt=new Date().toISOString()),await new Promise(l=>setTimeout(l,1e3)),console.log("Product saved:",o),f("/admin/products")}catch(a){console.error("Error saving product:",a)}finally{S(!1)}};return $?e.jsx("div",{className:"flex justify-center p-8",children:e.jsx(I,{})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>f("/admin/products"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-800",children:[e.jsx(W,{size:18}),e.jsx("span",{children:"Back to Products"})]}),e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:x==="create"?"Add New Product":"Edit Product"})]}),e.jsxs("form",{onSubmit:V,className:"space-y-8",children:[e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white p-6 shadow-md",children:[e.jsx("h2",{className:"mb-4 text-xl font-semibold text-gray-800",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"mb-1 block text-sm font-medium text-gray-700",children:"Product Name *"}),e.jsx("input",{id:"name",name:"name",type:"text",value:d.name,onChange:c,className:`w-full rounded-md border ${i.name?"border-red-500":"border-gray-300"} px-4 py-2 focus:border-primary focus:outline-none`}),i.name&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:i.name})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sku",className:"mb-1 block text-sm font-medium text-gray-700",children:"SKU *"}),e.jsx("input",{id:"sku",name:"sku",type:"text",value:d.sku,onChange:c,className:`w-full rounded-md border ${i.sku?"border-red-500":"border-gray-300"} px-4 py-2 focus:border-primary focus:outline-none`}),i.sku&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:i.sku})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"description",className:"mb-1 block text-sm font-medium text-gray-700",children:"Description"}),e.jsx("textarea",{id:"description",name:"description",rows:4,value:d.description,onChange:c,className:"w-full rounded-md border border-gray-300 px-4 py-2 focus:border-primary focus:outline-none"})]})]})]}),e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white p-6 shadow-md",children:[e.jsx("h2",{className:"mb-4 text-xl font-semibold text-gray-800",children:"Pricing and Inventory"}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"price",className:"mb-1 block text-sm font-medium text-gray-700",children:"Price (USD) *"}),e.jsx("input",{id:"price",name:"price",type:"number",step:"0.01",min:"0",value:d.price,onChange:c,className:`w-full rounded-md border ${i.price?"border-red-500":"border-gray-300"} px-4 py-2 focus:border-primary focus:outline-none`}),i.price&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:i.price})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"salePrice",className:"mb-1 block text-sm font-medium text-gray-700",children:"Sale Price (USD) (Optional)"}),e.jsx("input",{id:"salePrice",name:"salePrice",type:"number",step:"0.01",min:"0",value:d.salePrice||"",onChange:c,className:`w-full rounded-md border ${i.salePrice?"border-red-500":"border-gray-300"} px-4 py-2 focus:border-primary focus:outline-none`}),i.salePrice&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:i.salePrice})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"isActive",className:"mb-1 block text-sm font-medium text-gray-700",children:"Status"}),e.jsxs("select",{id:"isActive",name:"isActive",value:d.isActive.toString(),onChange:c,className:"w-full rounded-md border border-gray-300 px-4 py-2 focus:border-primary focus:outline-none",children:[e.jsx("option",{value:"true",children:"Active"}),e.jsx("option",{value:"false",children:"Inactive"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"stock",className:"mb-1 block text-sm font-medium text-gray-700",children:"Stock"}),e.jsx("input",{id:"stock",name:"stock",type:"number",min:"0",value:d.stock,onChange:c,className:`w-full rounded-md border ${i.stock?"border-red-500":"border-gray-300"} px-4 py-2 focus:border-primary focus:outline-none`}),i.stock&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:i.stock})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"minOrderQuantity",className:"mb-1 block text-sm font-medium text-gray-700",children:"Minimum Order Quantity"}),e.jsx("input",{id:"minOrderQuantity",name:"minOrderQuantity",type:"number",min:"1",value:d.minOrderQuantity,onChange:c,className:"w-full rounded-md border border-gray-300 px-4 py-2 focus:border-primary focus:outline-none"})]})]})]}),e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white p-6 shadow-md",children:[e.jsx("h2",{className:"mb-4 text-xl font-semibold text-gray-800",children:"CategorÃ­as y Proveedor"}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category.id",className:"mb-1 block text-sm font-medium text-gray-700",children:"Category *"}),e.jsxs("select",{id:"category.id",name:"category.id",value:d.category.id,onChange:c,className:`w-full rounded-md border ${i["category.id"]?"border-red-500":"border-gray-300"} px-4 py-2 focus:border-primary focus:outline-none`,children:[e.jsx("option",{value:"",children:"Select Category"}),O.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),i["category.id"]&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:i["category.id"]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"supplier.id",className:"mb-1 block text-sm font-medium text-gray-700",children:"Supplier *"}),e.jsxs("select",{id:"supplier.id",name:"supplier.id",value:d.supplier.id,onChange:c,className:`w-full rounded-md border ${i["supplier.id"]?"border-red-500":"border-gray-300"} px-4 py-2 focus:border-primary focus:outline-none`,children:[e.jsx("option",{value:"",children:"Select Supplier"}),P.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),i["supplier.id"]&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:i["supplier.id"]}),d.supplier&&d.supplier.id&&e.jsx("div",{className:"mt-2 rounded-md bg-gray-50 p-2",children:e.jsxs("p",{className:"text-xs text-gray-600",children:[d.supplier.contactEmail," | ",d.supplier.contactPhone]})})]})]})]}),e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white p-6 shadow-md",children:[e.jsx("h2",{className:"mb-4 text-xl font-semibold text-gray-800",children:"Product Images"}),e.jsxs("div",{className:"space-y-4",children:[b.map((s,r)=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-grow",children:[e.jsxs("label",{htmlFor:`image-${r}`,className:"mb-1 block text-sm font-medium text-gray-700",children:["Image URL ",r+1]}),e.jsx("input",{id:`image-${r}`,type:"text",value:s,onChange:t=>T(r,t.target.value),className:"w-full rounded-md border border-gray-300 px-4 py-2 focus:border-primary focus:outline-none"})]}),s&&e.jsx("div",{className:"h-16 w-16 flex-shrink-0",children:e.jsx("img",{src:s,alt:"Preview",className:"h-full w-full rounded-md object-cover",onError:t=>{const a=t.target;a.src="https://placehold.co/100x100?text=Error"}})}),e.jsx("button",{type:"button",onClick:()=>handleRemoveImage(r),className:"flex h-10 w-10 items-center justify-center rounded-full text-gray-500 hover:bg-gray-100 hover:text-red-600",children:e.jsx(E,{size:18})})]},r)),e.jsx("div",{children:e.jsxs("button",{type:"button",onClick:L,className:"flex items-center gap-2 rounded-md border border-gray-300 px-4 py-2 text-sm text-gray-600 hover:bg-gray-50",children:[e.jsx(G,{size:16}),"Add Image"]})})]})]}),e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white p-6 shadow-md",children:[e.jsx("h2",{className:"mb-4 text-xl font-semibold text-gray-800",children:"Specifications"}),e.jsx("div",{className:"mb-6 space-y-4",children:Object.entries(d.specifications).map(([s,r])=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-grow grid grid-cols-2 gap-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:s}),e.jsx("div",{className:"text-gray-800",children:r})]}),e.jsx("button",{type:"button",onClick:()=>Q(s),className:"flex h-8 w-8 items-center justify-center rounded-full text-gray-500 hover:bg-gray-100 hover:text-red-600",children:e.jsx(E,{size:16})})]},s))}),e.jsx("div",{className:"border-t border-gray-200 pt-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"spec-key",className:"mb-1 block text-sm font-medium text-gray-700",children:"Specification Name"}),e.jsx("input",{id:"spec-key",type:"text",value:g,onChange:s=>C(s.target.value),className:"w-full rounded-md border border-gray-300 px-4 py-2 focus:border-primary focus:outline-none",placeholder:"e.g. Brand, Color, Weight"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"spec-value",className:"mb-1 block text-sm font-medium text-gray-700",children:"Specification Value"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{id:"spec-value",type:"text",value:h,onChange:s=>A(s.target.value),className:"flex-grow rounded-md border border-gray-300 px-4 py-2 focus:border-primary focus:outline-none"}),e.jsx("button",{type:"button",onClick:U,disabled:!g.trim()||!h.trim(),className:"rounded-md bg-gray-200 px-4 py-2 text-gray-700 hover:bg-gray-300 disabled:opacity-50",children:"Add"})]})]})]})})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx("button",{type:"button",onClick:()=>f("/admin/products"),className:"rounded-lg border border-gray-300 bg-white px-6 py-2 text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:k||Object.keys(i).length>0,className:"flex items-center gap-2 bg-primary-600 hover:bg-primary-700 text-white py-2 px-4 rounded-lg transition-colors",children:k?e.jsxs(e.Fragment,{children:[e.jsx(I,{size:"sm"}),e.jsx("span",{children:"Saving..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{size:18}),e.jsx("span",{children:"Save Product"})]})})]}),Object.keys(i).length>0&&e.jsxs("div",{className:"rounded-lg border border-red-200 bg-red-50 p-4 text-red-700",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{size:20}),e.jsx("p",{className:"font-medium",children:"Please correct the following errors:"})]}),e.jsx("ul",{className:"ml-6 mt-2 list-disc",children:Object.entries(i).map(([s,r])=>e.jsx("li",{children:r},s))})]})]})]})};export{ie as P};
